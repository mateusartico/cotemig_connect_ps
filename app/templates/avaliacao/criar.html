{% extends "base.html" %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2 class="card-title">Avaliar Monitoria</h2>
    </div>
    
    <h3>{{ monitoria.titulo }}</h3>
    <p><strong>Monitor:</strong> {{ monitoria.monitor.nome }}</p>
    <p><strong>Data:</strong> {{ monitoria.data_hora.strftime('%d/%m/%Y às %H:%M') }}</p>
    
    <form method="POST">
        <div class="form-group">
            <label class="form-label">Nota (1 a 5 estrelas)</label>
            <div style="font-size: 2rem;">
                {% for i in range(1, 6) %}
                    <input type="radio" name="nota" value="{{ i }}" id="star{{ i }}" 
                           {% if avaliacao and avaliacao.nota == i %}checked{% endif %}
                           style="display: none;">
                    <label for="star{{ i }}" class="star" onclick="setRating({{ i }})">☆</label>
                {% endfor %}
            </div>
        </div>
        
        <div class="form-group">
            <label for="comentario" class="form-label">Comentário (opcional)</label>
            <textarea id="comentario" name="comentario" class="form-control" rows="4" 
                      placeholder="Compartilhe sua experiência...">{% if avaliacao %}{{ avaliacao.comentario }}{% endif %}</textarea>
        </div>
        
        <div style="display: flex; gap: 1rem;">
            <button type="submit" class="btn btn-primary">
                {% if avaliacao %}Atualizar Avaliação{% else %}Enviar Avaliação{% endif %}
            </button>
            <a href="{{ url_for('main.dashboard') }}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
</div>

<script>
function setRating(rating) {
    // Marcar o radio button
    document.getElementById('star' + rating).checked = true;
    
    // Atualizar visual das estrelas
    for (let i = 1; i <= 5; i++) {
        const star = document.querySelector('label[for="star' + i + '"]');
        star.textContent = i <= rating ? '⭐' : '☆';
    }
}

// Inicializar visual das estrelas
document.addEventListener('DOMContentLoaded', function() {
    const checked = document.querySelector('input[name="nota"]:checked');
    if (checked) {
        setRating(parseInt(checked.value));
    }
});
</script>
{% endblock %}